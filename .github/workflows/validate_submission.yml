name: Validate Submission

on:
  push:
    branches: ["main", "master"]
  workflow_dispatch:  # Allow manual triggers

jobs:
  validate:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Install uv
        uses: astral-sh/setup-uv@v4
        with:
          version: "latest"

      - name: Set up Python with uv
        run: uv python install 3.11

      - name: Run submission validation tests
        run: |
          echo "Running submission validation tests..."
          echo ""
          # Run pytest without syncing project dependencies (only need pytest + stdlib)
          uv run --no-project --with pytest pytest tests/test_submission_requirements.py -v --tb=short

      - name: Validation complete
        run: |
          echo ""
          echo "═══════════════════════════════════════════════════════════"
          echo "✅ All submission requirements passed!"
          echo "═══════════════════════════════════════════════════════════"
          echo ""
          echo "Next steps:"
          echo "- Your model will be evaluated on the test set during the next"
          echo "  evaluation period (we run evaluations periodically)"
          echo "- Results will be posted on Slack with an updated leaderboard"
          echo "- You'll be notified if your submission has any errors"
          echo ""
          echo "Keep improving your model on the validation set while you wait!"
          echo "═══════════════════════════════════════════════════════════"
